<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>justboot — Software Installer Assistant</title>
<style>
  :root {
    --primary: #5865F2;
    --primary-dark: #4752C4;
    --background: #1e1f22;
    --card-bg: #2b2d31;
    --text: #dbdee1;
    --text-secondary: #a5a8ad;
    --success: #3ba55c;
    --warning: #faa61a;
    --error: #ed4245;
    --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Category colors */
    --browsers: #3ba55c;
    --messengers: #5865F2;
    --games: #eb459e;
    --drivers: #faa61a;
    --music: #ed4245;
    --video: #9147ff;
    --utilities: #57F287;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    margin: 0;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    background: 
      radial-gradient(circle at 10% 20%, rgba(88, 101, 242, 0.15) 0%, transparent 20%),
      radial-gradient(circle at 90% 80%, rgba(88, 101, 242, 0.15) 0%, transparent 20%),
      var(--background);
    line-height: 1.5;
  }

  @supports (font-variation-settings: normal) {
    body { font-family: 'Inter var', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; }
  }

  header {
    background: rgba(30, 31, 34, 0.9);
    padding: 1.5rem 2rem;
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: 1px;
    color: white;
    text-transform: lowercase;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
    user-select: none;
    backdrop-filter: blur(8px);
    position: sticky;
    top: 0;
    z-index: 100;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .refresh-info {
    font-size: 0.9rem;
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  nav {
    background: rgba(35, 36, 40, 0.9);
    display: flex;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    overflow-x: auto;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(8px);
    position: sticky;
    top: 72px;
    z-index: 99;
  }

  nav button {
    background: transparent;
    border: none;
    color: var(--text-secondary);
    font-size: 0.9rem;
    padding: 0.5rem 1rem;
    cursor: pointer;
    border-radius: 4px;
    transition: var(--transition);
    white-space: nowrap;
    font-weight: 500;
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  nav button .count {
    background: rgba(255, 255, 255, 0.1);
    padding: 0.1rem 0.4rem;
    border-radius: 10px;
    font-size: 0.7rem;
    font-weight: 600;
  }

  nav button.active,
  nav button:hover {
    color: white;
  }

  /* Category-specific button colors */
  nav button[data-category="All"] {
    background: rgba(255, 255, 255, 0.1);
  }
  nav button[data-category="Browsers"].active,
  nav button[data-category="Browsers"]:hover {
    background: rgba(59, 165, 92, 0.2);
  }
  nav button[data-category="Messengers"].active,
  nav button[data-category="Messengers"]:hover {
    background: rgba(88, 101, 242, 0.2);
  }
  nav button[data-category="Games"].active,
  nav button[data-category="Games"]:hover {
    background: rgba(235, 69, 158, 0.2);
  }
  nav button[data-category="Drivers"].active,
  nav button[data-category="Drivers"]:hover {
    background: rgba(250, 166, 26, 0.2);
  }
  nav button[data-category="Music"].active,
  nav button[data-category="Music"]:hover {
    background: rgba(237, 66, 69, 0.2);
  }
  nav button[data-category="Video"].active,
  nav button[data-category="Video"]:hover {
    background: rgba(145, 71, 255, 0.2);
  }
  nav button[data-category="Utilities"].active,
  nav button[data-category="Utilities"]:hover {
    background: rgba(87, 242, 135, 0.2);
  }

  nav button.active::after {
    content: '';
    position: absolute;
    bottom: -0.75rem;
    left: 50%;
    transform: translateX(-50%);
    width: 4px;
    height: 4px;
    border-radius: 50%;
  }

  /* Category-specific indicators */
  nav button[data-category="Browsers"].active::after {
    background: var(--browsers);
  }
  nav button[data-category="Messengers"].active::after {
    background: var(--messengers);
  }
  nav button[data-category="Games"].active::after {
    background: var(--games);
  }
  nav button[data-category="Drivers"].active::after {
    background: var(--drivers);
  }
  nav button[data-category="Music"].active::after {
    background: var(--music);
  }
  nav button[data-category="Video"].active::after {
    background: var(--video);
  }
  nav button[data-category="Utilities"].active::after {
    background: var(--utilities);
  }

  main {
    padding: 2rem;
    max-width: 1400px;
    margin: 0 auto;
    flex-grow: 1;
    width: 100%;
  }

  .search-container {
    margin-bottom: 1.5rem;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 1rem;
    position: relative;
  }

  .search-wrapper {
    flex-grow: 1;
    min-width: 280px;
    position: relative;
  }

  .search-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    pointer-events: none;
  }

  #searchInput {
    width: 100%;
    padding: 0.75rem 1rem 0.75rem 2.5rem;
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    font-size: 0.95rem;
    outline: none;
    background-color: rgba(255, 255, 255, 0.05);
    color: var(--text);
    transition: var(--transition);
    font-family: inherit;
  }

  #searchInput::placeholder {
    color: var(--text-secondary);
  }

  #searchInput:focus {
    background-color: rgba(255, 255, 255, 0.1);
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(88, 101, 242, 0.3);
  }

  #clearSearchBtn {
    background: transparent;
    border: none;
    color: var(--text-secondary);
    padding: 0.5rem;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 700;
    user-select: none;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #clearSearchBtn:hover {
    color: var(--error);
    background: rgba(237, 66, 69, 0.1);
  }

  .filter-controls {
    display: flex;
    gap: 0.75rem;
    margin-left: auto;
  }

  .filter-btn {
    background: rgba(255, 255, 255, 0.05);
    border: none;
    color: var(--text-secondary);
    padding: 0.5rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 500;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  .filter-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text);
  }

  .filter-btn.active {
    background: var(--primary);
    color: white;
  }

  #searchWarning {
    color: var(--warning);
    font-weight: 500;
    margin-top: 0.5rem;
    font-size: 0.85rem;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-top: 1rem;
  }

  .card {
    background: var(--card-bg);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    transition: var(--transition);
    cursor: pointer;
    opacity: 0;
    animation: fadeInUp 0.4s cubic-bezier(0.2, 0.8, 0.4, 1) forwards;
    border: 1px solid rgba(255, 255, 255, 0.05);
    display: flex;
    flex-direction: column;
  }

  .card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(88, 101, 242, 0.3);
    border-color: rgba(88, 101, 242, 0.3);
  }

  .card-header {
    padding: 1.25rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  .card-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    color: white;
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    flex-shrink: 0;
  }

  /* Category-specific card icons */
  .card[data-category="Browsers"] .card-icon {
    background: linear-gradient(135deg, var(--browsers), #2d8a4d);
  }
  .card[data-category="Messengers"] .card-icon {
    background: linear-gradient(135deg, var(--messengers), var(--primary-dark));
  }
  .card[data-category="Games"] .card-icon {
    background: linear-gradient(135deg, var(--games), #d41d7a);
  }
  .card[data-category="Drivers"] .card-icon {
    background: linear-gradient(135deg, var(--drivers), #e0951a);
  }
  .card[data-category="Music"] .card-icon {
    background: linear-gradient(135deg, var(--music), #d13333);
  }
  .card[data-category="Video"] .card-icon {
    background: linear-gradient(135deg, var(--video), #7c3ad4);
  }
  .card[data-category="Utilities"] .card-icon {
    background: linear-gradient(135deg, var(--utilities), #45d16d);
  }

  .card-title {
    font-weight: 600;
    font-size: 1.1rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .card-category {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-top: 0.25rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .card-body {
    padding: 1.25rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .card-description {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 1.25rem;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .card-footer {
    margin-top: auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .btn-download {
    background: var(--primary);
    color: white;
    border: none;
    padding: 0.6rem 1.25rem;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
    text-decoration: none;
    user-select: none;
    transition: var(--transition);
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-shrink: 0;
  }

  .btn-download:hover {
    background: var(--primary-dark);
    box-shadow: 0 4px 12px rgba(88, 101, 242, 0.4);
  }

  /* Category-specific download buttons */
  .card[data-category="Browsers"] .btn-download {
    background: var(--browsers);
  }
  .card[data-category="Browsers"] .btn-download:hover {
    background: #2d8a4d;
    box-shadow: 0 4px 12px rgba(59, 165, 92, 0.4);
  }
  .card[data-category="Messengers"] .btn-download {
    background: var(--messengers);
  }
  .card[data-category="Games"] .btn-download {
    background: var(--games);
  }
  .card[data-category="Games"] .btn-download:hover {
    background: #d41d7a;
    box-shadow: 0 4px 12px rgba(235, 69, 158, 0.4);
  }
  .card[data-category="Drivers"] .btn-download {
    background: var(--drivers);
  }
  .card[data-category="Drivers"] .btn-download:hover {
    background: #e0951a;
    box-shadow: 0 4px 12px rgba(250, 166, 26, 0.4);
  }
  .card[data-category="Music"] .btn-download {
    background: var(--music);
  }
  .card[data-category="Music"] .btn-download:hover {
    background: #d13333;
    box-shadow: 0 4px 12px rgba(237, 66, 69, 0.4);
  }
  .card[data-category="Video"] .btn-download {
    background: var(--video);
  }
  .card[data-category="Video"] .btn-download:hover {
    background: #7c3ad4;
    box-shadow: 0 4px 12px rgba(145, 71, 255, 0.4);
  }
  .card[data-category="Utilities"] .btn-download {
    background: var(--utilities);
  }
  .card[data-category="Utilities"] .btn-download:hover {
    background: #45d16d;
    box-shadow: 0 4px 12px rgba(87, 242, 135, 0.4);
  }

  .card-actions {
    display: flex;
    gap: 0.5rem;
  }

  .card-action {
    background: rgba(255, 255, 255, 0.05);
    border: none;
    color: var(--text-secondary);
    width: 32px;
    height: 32px;
    border-radius: 6px;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .card-action:hover {
    background: rgba(255, 255, 255, 0.1);
    color: var(--text);
  }

  .loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    padding: 3rem 2rem;
    color: var(--text-secondary);
  }

  .loading-spinner {
    width: 48px;
    height: 48px;
    border: 4px solid rgba(88, 101, 242, 0.2);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  .empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    padding: 3rem 2rem;
    text-align: center;
  }

  .empty-icon {
    font-size: 2.5rem;
    color: var(--text-secondary);
  }

  .empty-title {
    font-weight: 600;
    color: var(--text);
  }

  .empty-description {
    color: var(--text-secondary);
    max-width: 400px;
  }

  footer {
    text-align: center;
    padding: 1.5rem;
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin-top: auto;
    user-select: none;
    background: rgba(30, 31, 34, 0.9);
    backdrop-filter: blur(8px);
  }

  footer a {
    color: var(--primary);
    text-decoration: none;
    font-weight: 500;
  }

  footer a:hover {
    text-decoration: underline;
  }

  @keyframes fadeInUp {
    0% {
      opacity: 0;
      transform: translateY(12px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-thumb {
    background: rgba(88, 101, 242, 0.5);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
  }

  /* Dark/Light theme variants */
  @media (prefers-color-scheme: light) {
    :root {
      --primary: #5865F2;
      --primary-dark: #4752C4;
      --background: #f2f3f5;
      --card-bg: #ffffff;
      --text: #2e3338;
      --text-secondary: #747f8d;
      --success: #3ba55c;
      --warning: #faa61a;
      --error: #ed4245;
      
      /* Light theme category colors */
      --browsers: #3ba55c;
      --messengers: #5865F2;
      --games: #eb459e;
      --drivers: #faa61a;
      --music: #ed4245;
      --video: #9147ff;
      --utilities: #57F287;
    }

    body {
      background: 
        radial-gradient(circle at 10% 20%, rgba(88, 101, 242, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(88, 101, 242, 0.1) 0%, transparent 20%),
        var(--background);
    }

    .card {
      border: 1px solid rgba(0, 0, 0, 0.05);
    }

    #searchInput {
      background-color: rgba(0, 0, 0, 0.03);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    #searchInput:focus {
      background-color: white;
      border-color: var(--primary);
    }
    
    nav button {
      color: var(--text-secondary);
    }
    
    nav button:hover {
      color: var(--text);
    }
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

<header>
  <span>justboot</span>
  <div class="refresh-info">
    <i class="fas fa-sync-alt"></i>
    <span id="refreshTimer">Auto-refresh in 5:00</span>
  </div>
</header>

<nav id="categoryNav" aria-label="Categories">
  <!-- Категории будут добавлены скриптом -->
</nav>

<main>
  <div class="search-container">
    <div class="search-wrapper">
      <span class="search-icon"><i class="fas fa-search"></i></span>
      <input id="searchInput" type="search" placeholder="Search software..." autocomplete="off" aria-label="Search software" />
    </div>
    <button id="clearSearchBtn" title="Clear Search" aria-label="Clear Search" style="display:none;">
      <i class="fas fa-times"></i>
    </button>
    <div class="filter-controls">
      <button class="filter-btn active" data-filter="all">
        <i class="fas fa-layer-group"></i> All
      </button>
      <button class="filter-btn" data-filter="favorites">
        <i class="fas fa-star"></i> Favorites
      </button>
    </div>
  </div>
  <div id="searchWarning" style="display:none;">
    <i class="fas fa-info-circle"></i> Search works only inside the selected category
  </div>

  <div class="loading" id="loading">
    <div class="loading-spinner"></div>
    <div>Loading software catalog...</div>
  </div>

  <div class="cards" id="cardsContainer" style="display:none;" role="list"></div>

  <div class="empty-state" id="emptyState" style="display:none;">
    <div class="empty-icon"><i class="fas fa-box-open"></i></div>
    <h3 class="empty-title">No software found</h3>
    <p class="empty-description">Try changing your search query or select a different category</p>
  </div>
</main>

<footer>
  © 2025 <a href="https://github.com/Tool-xx/justboot.github.io" target="_blank">justboot</a> — Software Installer Assistant
</footer>

<script>
  // Конфигурация
  const DATA_URL = 'https://raw.githubusercontent.com/Tool-xx/justboot.github.io/main/templ/base.txt';
  const STORAGE_KEY = 'justboot_favorites';
  const CATEGORIES = ['Browsers', 'Messengers', 'Games', 'Drivers', 'Music', 'Video', 'Utilities'];
  const REFRESH_INTERVAL = 5 * 60 * 1000; // 5 минут в миллисекундах

  // DOM Elements
  const nav = document.getElementById('categoryNav');
  const cardsContainer = document.getElementById('cardsContainer');
  const loadingElem = document.getElementById('loading');
  const emptyState = document.getElementById('emptyState');
  const searchInput = document.getElementById('searchInput');
  const clearSearchBtn = document.getElementById('clearSearchBtn');
  const searchWarning = document.getElementById('searchWarning');
  const filterButtons = document.querySelectorAll('.filter-btn');
  const refreshTimer = document.getElementById('refreshTimer');

  // State
  let softwareData = {};
  let allSoftware = [];
  let currentCategory = 'All';
  let currentFilter = 'all';
  let favorites = new Set(JSON.parse(localStorage.getItem(STORAGE_KEY)) || []);
  let currentDisplayed = [];
  let refreshInterval;
  let timeLeft = 300; // 5 минут в секундах

  // Initialize
  document.addEventListener('DOMContentLoaded', () => {
    loadSoftwareList();
    setupEventListeners();
    startAutoRefresh();
  });

  function setupEventListeners() {
    // Search
    searchInput.addEventListener('input', handleSearch);
    clearSearchBtn.addEventListener('click', clearSearch);
    
    // Filter buttons
    filterButtons.forEach(btn => {
      btn.addEventListener('click', () => setActiveFilter(btn.dataset.filter));
    });
  }

  function startAutoRefresh() {
    // Обновляем таймер каждую секунду
    const timerInterval = setInterval(() => {
      timeLeft--;
      const minutes = Math.floor(timeLeft / 60);
      const seconds = timeLeft % 60;
      refreshTimer.textContent = `Auto-refresh in ${minutes}:${seconds.toString().padStart(2, '0')}`;
      
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        refreshTimer.textContent = 'Refreshing...';
        loadSoftwareList();
      }
    }, 1000);

    // Полное обновление каждые 5 минут
    refreshInterval = setInterval(() => {
      loadSoftwareList();
      timeLeft = 300; // Сброс таймера
    }, REFRESH_INTERVAL);
  }

  async function loadSoftwareList() {
    try {
      const res = await fetch(DATA_URL);
      if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
      const text = await res.text();

      parseSoftwareData(text);
      createCategoryButtons();
      setActiveCategory('All');

      loadingElem.style.display = 'none';
      cardsContainer.style.display = 'grid';
    } catch (err) {
      console.error('Failed to load software list:', err);
      loadingElem.innerHTML = `
        <div class="empty-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div>Failed to load software catalog</div>
        <button class="btn-download" style="margin-top: 1rem;" onclick="location.reload()">
          <i class="fas fa-sync-alt"></i> Retry
        </button>
      `;
    }
  }

  function parseSoftwareData(text) {
    softwareData = {};
    allSoftware = [];
    
    // Initialize categories
    CATEGORIES.forEach(category => {
      softwareData[category] = [];
    });
    
    text.split('\n').forEach(line => {
      const parsed = parseLine(line);
      if (parsed) {
        if (softwareData[parsed.category]) {
          const software = {
            ...parsed,
            id: generateId(parsed.name),
            isFavorite: favorites.has(parsed.name)
          };
          
          softwareData[parsed.category].push(software);
          allSoftware.push(software);
        }
      }
    });
    
    // Sort each category alphabetically
    CATEGORIES.forEach(category => {
      if (softwareData[category]) {
        softwareData[category].sort((a, b) => a.name.localeCompare(b.name));
      }
    });
    
    // Sort allSoftware
    allSoftware.sort((a, b) => a.name.localeCompare(b.name));
  }

  function parseLine(line) {
    line = line.trim();
    if (!line || !line.startsWith('#')) return null;
    
    // Формат: #Category 'Name' - 'Link'
    const regex = /^#(Browsers|Messengers|Games|Drivers|Music|Video|Utilities)\s+'(.+?)'\s+-\s+'(.+?)'$/;
    const match = line.match(regex);
    if (!match) return null;
    
    return {
      category: match[1],
      name: match[2],
      link: match[3],
      description: getDefaultDescription(match[1])
    };
  }

  function getDefaultDescription(category) {
    const descriptions = {
      'Browsers': 'Web browser application',
      'Messengers': 'Messaging and communication software',
      'Games': 'Game or gaming-related software',
      'Drivers': 'Device drivers or system utilities',
      'Music': 'Music player or audio software',
      'Video': 'Video player or editing software',
      'Utilities': 'System utility or tool'
    };
    return descriptions[category] || 'Software application';
  }

  function generateId(name) {
    return name.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]/g, '');
  }

  function createCategoryButtons() {
    nav.innerHTML = '';
    
    // Add All button first
    const allBtn = createCategoryButton('All', allSoftware.length);
    allBtn.classList.add('active');
    nav.appendChild(allBtn);
    
    // Add other categories in predefined order
    CATEGORIES.forEach(category => {
      if (softwareData[category] && softwareData[category].length > 0) {
        nav.appendChild(createCategoryButton(category, softwareData[category].length));
      }
    });
  }

  function createCategoryButton(category, count) {
    const btn = document.createElement('button');
    btn.textContent = category;
    btn.dataset.category = category;
    
    // Добавляем счетчик
    const countSpan = document.createElement('span');
    countSpan.className = 'count';
    countSpan.textContent = count;
    btn.appendChild(countSpan);
    
    btn.addEventListener('click', () => setActiveCategory(category));
    return btn;
  }

  function setActiveCategory(category) {
    currentCategory = category;
    
    // Update active button
    document.querySelectorAll('nav button').forEach(btn => {
      btn.classList.toggle('active', btn.textContent === category);
    });
    
    // Reset search
    searchInput.value = '';
    clearSearchBtn.style.display = 'none';
    searchWarning.style.display = 'none';
    
    // Update displayed items
    updateDisplayedItems();
  }

  function setActiveFilter(filter) {
    currentFilter = filter;
    
    // Update active button
    filterButtons.forEach(btn => {
      btn.classList.toggle('active', btn.dataset.filter === filter);
    });
    
    // Update displayed items
    updateDisplayedItems();
  }

  function updateDisplayedItems() {
    let items = [];
    
    // Get base items based on category
    if (currentCategory === 'All') {
      items = [...allSoftware];
    } else {
      items = [...(softwareData[currentCategory] || [])];
    }
    
    // Apply filter
    if (currentFilter === 'favorites') {
      items = items.filter(item => favorites.has(item.name));
    }
    
    // Apply search
    const searchQuery = searchInput.value.trim().toLowerCase();
    if (searchQuery) {
      items = items.filter(item => 
        item.name.toLowerCase().includes(searchQuery) ||
        (item.description && item.description.toLowerCase().includes(searchQuery))
      );
    }
    
    currentDisplayed = items;
    renderCards(items);
  }

  function renderCards(items) {
    cardsContainer.innerHTML = '';
    
    if (items.length === 0) {
      cardsContainer.style.display = 'none';
      emptyState.style.display = 'flex';
      return;
    }
    
    emptyState.style.display = 'none';
    cardsContainer.style.display = 'grid';
    
    items.forEach((item, index) => {
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.id = item.id;
      card.dataset.category = item.category;
      card.style.animationDelay = `${index * 0.05}s`;
      card.setAttribute('role', 'listitem');
      
      // Favorite star with different color if favorited
      const isFavorite = favorites.has(item.name);
      const starIcon = isFavorite ? 'fas fa-star' : 'far fa-star';
      const starColor = isFavorite ? 'color: #f8d448;' : '';
      
      card.innerHTML = `
        <div class="card-header">
          <div class="card-icon">${item.name[0].toUpperCase()}</div>
          <div>
            <div class="card-title" title="${item.name}">${item.name}</div>
            <div class="card-category">${item.category}</div>
          </div>
        </div>
        <div class="card-body">
          <div class="card-description" title="${item.description}">${item.description}</div>
          <div class="card-footer">
            <a href="${item.link}" class="btn-download" target="_blank" rel="noopener noreferrer">
              <i class="fas fa-download"></i> Download
            </a>
            <div class="card-actions">
              <button class="card-action" aria-label="Add to favorites" data-action="favorite" style="${starColor}">
                <i class="${starIcon}"></i>
              </button>
              <button class="card-action" aria-label="Copy link" data-action="copy">
                <i class="fas fa-link"></i>
              </button>
            </div>
          </div>
        </div>
      `;
      
      cardsContainer.appendChild(card);
    });
    
    // Add event listeners to card actions
    document.querySelectorAll('[data-action="favorite"]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleFavorite(btn.closest('.card').dataset.id);
      });
    });
    
    document.querySelectorAll('[data-action="copy"]').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        const card = btn.closest('.card');
        const link = card.querySelector('.btn-download').href;
        copyToClipboard(link);
        
        // Show feedback
        const icon = btn.querySelector('i');
        icon.className = 'fas fa-check';
        setTimeout(() => {
          icon.className = 'fas fa-link';
        }, 2000);
      });
    });
    
    // Make whole card clickable (opens download)
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('click', () => {
        const link = card.querySelector('.btn-download').href;
        window.open(link, '_blank');
      });
    });
  }

  function toggleFavorite(softwareId) {
    const software = allSoftware.find(item => item.id === softwareId);
    if (!software) return;
    
    if (favorites.has(software.name)) {
      favorites.delete(software.name);
    } else {
      favorites.add(software.name);
    }
    
    // Update localStorage
    localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(favorites)));
    
    // Update UI
    if (currentFilter === 'favorites') {
      updateDisplayedItems();
    } else {
      const starIcon = document.querySelector(`.card[data-id="${softwareId}"] [data-action="favorite"] i`);
      if (starIcon) {
        const isFavorite = favorites.has(software.name);
        starIcon.className = isFavorite ? 'fas fa-star' : 'far fa-star';
        starIcon.parentElement.style.color = isFavorite ? '#f8d448' : '';
      }
    }
  }

  function handleSearch(e) {
    const query = e.target.value;
    
    if (query.trim()) {
      clearSearchBtn.style.display = 'flex';
      searchWarning.style.display = 'flex';
    } else {
      clearSearchBtn.style.display = 'none';
      searchWarning.style.display = 'none';
    }
    
    updateDisplayedItems();
  }

  function clearSearch() {
    searchInput.value = '';
    clearSearchBtn.style.display = 'none';
    searchWarning.style.display = 'none';
    updateDisplayedItems();
    searchInput.focus();
  }

  async function copyToClipboard(text) {
    try {
      await navigator.clipboard.writeText(text);
    } catch (err) {
      console.error('Failed to copy:', err);
      // Fallback for older browsers
      const textarea = document.createElement('textarea');
      textarea.value = text;
      document.body.appendChild(textarea);
      textarea.select();
      document.execCommand('copy');
      document.body.removeChild(textarea);
    }
  }
</script>

</body>
</html>
